<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Client | Projects</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script src="https://unpkg.com/lucide@latest"></script>
<link rel="stylesheet" href="../assets/css/theme.css"/>
</head>
<body class="d-flex flex-column min-vh-100">

<!-- Navbar -->
<nav class="navbar navbar-expand-lg sticky-top">
  <div class="container-fluid">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNav">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="mainNav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
        <li class="nav-item"><a class="nav-link" href="index.html">Dashboard</a></li>
        <li class="nav-item"><a class="nav-link active" href="projects.html">Projects</a></li>
        <li class="nav-item"><a class="nav-link" href="invoices.html">Invoices</a></li>
        <li class="nav-item"><a class="nav-link" href="support.html">Support</a></li>
        <li class="nav-item"><a class="nav-link" href="profile.html">Profile</a></li>
      </ul>
      <div class="d-flex align-items-center gap-2">
        <button class="btn btn-sm btn-neon" onclick="logout()">Logout</button>
      </div>
    </div>
  </div>
</nav>

<main class="flex-fill container py-4">
<script>requireRole('client');</script>

<!-- Stats Overview -->
<div class="row g-3 mb-4">
  <div class="col-6 col-lg-3"><div class="card p-3 text-center" style="background:#111921;color:#cfeff0;"><h6>Active</h6><div class="display-6 neon">6</div></div></div>
  <div class="col-6 col-lg-3"><div class="card p-3 text-center" style="background:#111921;color:#cfeff0;"><h6>Completed</h6><div class="display-6 neon">18</div></div></div>
  <div class="col-6 col-lg-3"><div class="card p-3 text-center" style="background:#111921;color:#cfeff0;"><h6>Pending</h6><div class="display-6 neon">3</div></div></div>
  <div class="col-6 col-lg-3"><div class="card p-3 text-center" style="background:#111921;color:#cfeff0;"><h6>Total</h6><div class="display-6 neon">27</div></div></div>
</div>

<!-- Search + Filter -->
<div class="card p-3 mb-4" style="background:#111921;color:#cfeff0;">
  <div class="row g-2 align-items-center">
    <div class="col-md-6"><input type="text" class="form-control form-control-sm" placeholder="Search projects..."></div>
    <div class="col-md-3"><select class="form-select form-select-sm"><option>All Status</option><option>In Progress</option><option>Review</option><option>Design</option><option>Completed</option></select></div>
    <div class="col-md-3 text-end"><button class="btn btn-neon btn-sm">+ New Request</button></div>
  </div>
</div>

<!-- Projects & Charts -->
<div class="row g-3 mb-4">
  <!-- Projects Table (left) -->
  <div class="col-lg-8">
    <div class="card p-3 h-100" style="background:#111921;color:#cfeff0;">
      <h5 class="mb-3">Your Automation Projects</h5>
     <div class="table-responsive">
  <table class="table table-hover align-middle mb-0" style="background:#0b0f17;color:#cfeff0;">
    <thead>
      <tr><th>ID</th><th>Name</th><th>Status</th><th>Manager</th><th>ETA</th></tr>
    </thead>
    <tbody>
      <tr><td>#AP-1023</td><td>Packaging Line Retrofit</td><td><span class="badge-neon">In Progress</span></td><td>J. Patel</td><td>Oct 10</td></tr>
      <tr><td>#AP-1041</td><td>SCADA Migration</td><td><span class="badge-neon">Review</span></td><td>M. Singh</td><td>Sep 22</td></tr>
      <tr><td>#AP-1050</td><td>Robot Cell Integration</td><td><span class="badge-neon">Design</span></td><td>A. Verma</td><td>Nov 05</td></tr>
      <tr><td>#AP-1062</td><td>Energy Monitoring System</td><td><span class="badge-neon">In Progress</span></td><td>S. Gupta</td><td>Nov 15</td></tr>
      <tr><td>#AP-1075</td><td>PLC Standardization</td><td><span class="badge-neon">Completed</span></td><td>K. Sharma</td><td>Aug 28</td></tr>
      <tr><td>#AP-1083</td><td>Conveyor Line Upgrade</td><td><span class="badge-neon">Pending</span></td><td>L. Thomas</td><td>Dec 01</td></tr>
      <tr><td>#AP-1090</td><td>Remote SCADA Access</td><td><span class="badge-neon">In Progress</span></td><td>M. Singh</td><td>Oct 20</td></tr>
      <tr><td>#AP-1102</td><td>Vision Inspection Setup</td><td><span class="badge-neon">Design</span></td><td>A. Verma</td><td>Nov 18</td></tr>
      <tr><td>#AP-1115</td><td>Warehouse AGV Deployment</td><td><span class="badge-neon">In Progress</span></td><td>J. Patel</td><td>Dec 12</td></tr>
      <tr><td>#AP-1120</td><td>Factory Energy Audit</td><td><span class="badge-neon">Review</span></td><td>S. Gupta</td><td>Oct 30</td></tr>
      <tr><td>#AP-1133</td><td>Process Safety Upgrade</td><td><span class="badge-neon">Completed</span></td><td>K. Sharma</td><td>Aug 10</td></tr>
      <tr><td>#AP-1141</td><td>IoT Sensor Deployment</td><td><span class="badge-neon">Pending</span></td><td>L. Thomas</td><td>Dec 22</td></tr>
      <tr><td>#AP-1150</td><td>Robotic Arm Calibration</td><td><span class="badge-neon">Design</span></td><td>A. Verma</td><td>Nov 28</td></tr>
      <tr><td>#AP-1164</td><td>MES System Rollout</td><td><span class="badge-neon">In Progress</span></td><td>M. Singh</td><td>Jan 05</td></tr>
      <tr><td>#AP-1172</td><td>Data Historian Upgrade</td><td><span class="badge-neon">Review</span></td><td>S. Gupta</td><td>Oct 25</td></tr>
      <tr><td>#AP-1180</td><td>Electrical Panel Retrofit</td><td><span class="badge-neon">In Progress</span></td><td>K. Sharma</td><td>Dec 08</td></tr>
      <tr><td>#AP-1195</td><td>Production Dashboard</td><td><span class="badge-neon">Completed</span></td><td>L. Thomas</td><td>Sep 05</td></tr>
      <tr><td>#AP-1201</td><td>Cloud Integration</td><td><span class="badge-neon">Design</span></td><td>J. Patel</td><td>Jan 15</td></tr>
    </tbody>
  </table>
</div>

    </div>
  </div>

  <!-- Charts (right) -->
  <div class="col-lg-4 d-flex flex-column gap-3">
    <div class="card p-3 flex-fill" style="background:#111921;color:#cfeff0;">
      <h6>Project Performance Radar</h6>
      <canvas id="projectsRadar" height="160"></canvas>
    </div>
    <div class="card p-3 flex-fill" style="background:#111921;color:#cfeff0;">
      <h6>Projects by Manager & Status</h6>
      <canvas id="managerStacked" height="160"></canvas>
    </div>
  </div>
</div>

<!-- Announcements & Documents -->
<div class="row g-3">
  <div class="col-lg-6">
    <div class="card p-3 h-100" style="background:#111921;color:#cfeff0;">
      <h5>Project Announcements</h5>
      <ul class="mb-0">
        <li>âš¡ Robot Cell Integration design approved</li>
        <li>ðŸ“… FAT scheduled for SCADA Migration on Sep 20</li>
        <li>ðŸ›  Packaging Line Retrofit parts delivery expected next week</li>
      </ul>
    </div>
  </div>
  <div class="col-lg-6">
    <div class="card p-3 h-100" style="background:#111921;color:#cfeff0;">
      <h5>Recent Documents</h5>
      <ul class="mb-0">
        <li><i data-lucide="file-text"></i> SCADA_Migration_Specs.pdf</li>
        <li><i data-lucide="file-text"></i> RobotCell_Layout.dwg</li>
        <li><i data-lucide="file-text"></i> PackagingLine_Timeline.xlsx</li>
      </ul>
    </div>
  </div>
</div>

</main>

<!-- Footer -->
<footer class="mt-auto py-3">
  <div class="container text-center small-muted">Â© 2025 AutoLogic Automation Portal</div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="../assets/js/auth.js"></script>
<script src="../assets/js/ui.js"></script>
<script>
document.getElementById('themeBtn')?.addEventListener('click', function(){
  const isMoon = this.querySelector('i').getAttribute('data-lucide')==='moon';
  this.innerHTML = isMoon ? '<i data-lucide="sun"></i>' : '<i data-lucide="moon"></i>';
  if(window.lucide) lucide.createIcons();
  document.body.classList.toggle('light');
});

// Charts
document.addEventListener('DOMContentLoaded', ()=>{
  if(window.lucide) lucide.createIcons();

  // Radar chart for project KPIs
  const radarCtx = document.getElementById('projectsRadar');
  if(radarCtx){
    new Chart(radarCtx, {
      type: 'radar',
      data: {
        labels: ['Design', 'In Progress', 'Review', 'Completed', 'Pending'],
        datasets: [{
          label: 'Project Distribution',
          data: [5, 6, 4, 18, 3],
          backgroundColor: 'rgba(0,255,247,0.2)',
          borderColor: 'rgba(0,255,247,0.8)',
          pointBackgroundColor: '#00fff7'
        }]
      },
      options: {
        scales: {
          r: {
            angleLines: { color:'#333' },
            grid: { color:'#333' },
            pointLabels: { color:'#cfeff0' },
            ticks: { color:'#cfeff0' }
          }
        },
        plugins:{ legend:{ labels:{ color:'#cfeff0' } } }
      }
    });
  }

  // Stacked bar for projects per manager by status
  const stackedCtx = document.getElementById('managerStacked');
  if(stackedCtx){
    new Chart(stackedCtx, {
      type: 'bar',
      data: {
        labels: ['J. Patel','M. Singh','A. Verma','S. Gupta','K. Sharma','L. Thomas'],
        datasets: [
          { label:'In Progress', data:[3,2,2,1,2,1], backgroundColor:'rgba(0,255,247,0.6)' },
          { label:'Completed', data:[1,2,1,1,2,1], backgroundColor:'rgba(0,200,150,0.6)' },
          { label:'Pending', data:[1,0,1,1,0,1], backgroundColor:'rgba(255,99,132,0.6)' },
          { label:'Design', data:[1,2,2,0,0,0], backgroundColor:'rgba(200,150,255,0.6)' },
          { label:'Review', data:[0,1,0,2,0,0], backgroundColor:'rgba(255,206,86,0.6)' }
        ]
      },
      options: {
        responsive: true,
        plugins:{ legend:{ labels:{ color:'#cfeff0' } } },
        scales: {
          x: { stacked:true, ticks:{ color:'#cfeff0' }, grid:{ color:'#333' } },
          y: { stacked:true, ticks:{ color:'#cfeff0' }, grid:{ color:'#333' } }
        }
      }
    });
  }
});
</script>
</body>
</html>

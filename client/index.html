<!doctype html>
<html lang="en"><head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Client | Dashboard</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script src="https://unpkg.com/lucide@latest"></script>
<link rel="stylesheet" href="../assets/css/theme.css"/>
</head>
<body class="d-flex flex-column min-vh-100">
<nav class="navbar navbar-expand-lg sticky-top">
  <div class="container-fluid">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNav">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="mainNav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
        <li class="nav-item"><a class="nav-link active" href="index.html">Dashboard</a></li>
        <li class="nav-item"><a class="nav-link" href="projects.html">Projects</a></li>
        <li class="nav-item"><a class="nav-link" href="invoices.html">Invoices</a></li>
        <li class="nav-item"><a class="nav-link" href="support.html">Support</a></li>
        <li class="nav-item"><a class="nav-link" href="profile.html">Profile</a></li>
      </ul>
      <div class="d-flex align-items-center gap-2">
        <button class="btn btn-sm btn-neon" onclick="logout()">Logout</button>
      </div>
    </div>
  </div>
</nav>
<main class="flex-fill container py-4">
<script>requireRole('client');</script>

<!-- Welcome -->
<div class="row mb-3">
  <div class="col">
    <h3>Welcome back, Client</h3>
    <p class="small-muted">Here’s your project and account overview</p>
  </div>
</div>

<!-- Stats Cards -->
<div class="row g-3 row-cols-1 row-cols-sm-2 row-cols-lg-4">
  <div class="col"><div class="card p-3"><h6>Active Projects</h6><div class="display-6 neon">18</div><p class="small-muted mb-0">Ongoing integrations</p></div></div>
  <div class="col"><div class="card p-3"><h6>Completed</h6><div class="display-6 neon">142</div><p class="small-muted mb-0">Delivered this year</p></div></div>
  <div class="col"><div class="card p-3"><h6>Pending</h6><div class="display-6 neon">6</div><p class="small-muted mb-0">Awaiting approval</p></div></div>
  <div class="col"><div class="card p-3"><h6>Upcoming Meetings</h6><div class="display-6 neon">3</div><p class="small-muted mb-0">Scheduled this week</p></div></div>
</div>

<!-- Charts -->
<div class="row mt-4 g-3">
  <div class="col-12 col-lg-6">
    <div class="card p-3 h-100">
      <h5>Weekly Throughput</h5>
      <canvas id="mainChart" height="120"></canvas>
    </div>
  </div>
  <div class="col-12 col-lg-6">
    <div class="card p-3 h-100">
      <h5>Invoice Overview</h5>
      <canvas id="invoiceChart" height="120"></canvas>
    </div>
  </div>
</div>

<!-- Tasks & Recent Activity -->
<div class="row mt-4 g-3">
  <div class="col-12 col-lg-6">
    <div class="card p-3 h-100">
      <h5>Next Tasks</h5>
      <ul class="mb-0">
        <li>Review PLC ladder logic</li>
        <li>Approve conveyor sensor spec</li>
        <li>Join FAT call</li>
      </ul>
    </div>
  </div>
  <div class="col-12 col-lg-6">
    <div class="card p-3 h-100">
      <h5>Recent Activity</h5>
      <div class="table-responsive">
        <table class="table table-hover align-middle mb-0">
          <thead>
            <tr><th>Date</th><th>Action</th></tr>
          </thead>
          <tbody>
            <tr><td>2025-09-03</td><td>Uploaded SCADA screens v2</td></tr>
            <tr><td>2025-09-02</td><td>Signed off FAT checklist</td></tr>
            <tr><td>2025-09-01</td><td>Closed ticket #2487</td></tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<!-- Support Tickets -->
<div class="row mt-4">
  <div class="col-12">
    <div class="card p-3">
      <h5>Open Support Tickets</h5>
      <div class="table-responsive">
        <table class="table table-hover align-middle mb-0">
          <thead>
            <tr><th>ID</th><th>Subject</th><th>Status</th></tr>
          </thead>
          <tbody>
            <tr><td>#4532</td><td>PLC program bug</td><td><span class="badge-neon">Open</span></td></tr>
            <tr><td>#4510</td><td>Invoice correction</td><td><span class="badge-neon">Pending</span></td></tr>
            <tr><td>#4498</td><td>Support call request</td><td><span class="badge-neon">In Progress</span></td></tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

</main>

<footer class="mt-auto py-3">
  <div class="container text-center small-muted">© 2025 AutoLogic Automation Portal</div>
</footer>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="../assets/js/auth.js"></script>
<script src="../assets/js/ui.js"></script>
<script>
document.getElementById('themeBtn')?.addEventListener('click', function(){
  const isMoon = this.querySelector('i').getAttribute('data-lucide')==='moon';
  this.innerHTML = isMoon ? '<i data-lucide="sun"></i>' : '<i data-lucide="moon"></i>';
  if(window.lucide) lucide.createIcons();
  document.body.classList.toggle('light');
});

// Charts
document.addEventListener('DOMContentLoaded', ()=>{
  if(window.lucide) lucide.createIcons();

  // Weekly throughput chart
  const ctx1 = document.getElementById('mainChart');
  if(ctx1){
    new Chart(ctx1, {
      type:'line',
      data:{
        labels:['Mon','Tue','Wed','Thu','Fri','Sat','Sun'],
        datasets:[{label:'Throughput', data:[12,18,13,19,22,25,21], borderColor:'#00fff7', backgroundColor:'rgba(0,255,247,.12)', fill:true, tension:.35}]
      },
      options:{plugins:{legend:{labels:{color:'#cfeff0'}}}, scales:{x:{ticks:{color:'#cfeff0'}, grid:{color:'rgba(0,255,247,.06)'}}, y:{ticks:{color:'#cfeff0'}, grid:{color:'rgba(0,255,247,.06)'}}}}
    });
  }

  // Invoice overview chart
  const ctx2 = document.getElementById('invoiceChart');
  if(ctx2){
    new Chart(ctx2, {
      type:'doughnut',
      data:{
        labels:['Paid','Pending','Overdue'],
        datasets:[{data:[65,25,10], backgroundColor:['rgba(0,255,247,.6)','rgba(0,255,247,.3)','rgba(255,99,132,.6)']}]
      },
      options:{plugins:{legend:{labels:{color:'#cfeff0'}}}}
    });
  }
});
</script>
</body></html>